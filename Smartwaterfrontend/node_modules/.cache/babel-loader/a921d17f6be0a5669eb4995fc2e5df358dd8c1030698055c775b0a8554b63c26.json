{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Shraddha sajwan\\\\smart-water-frontend\\\\src\\\\components\\\\BluetoothReader.js\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst DEFAULT_SERVICE = '0000ffe0-0000-1000-8000-00805f9b34fb'; // example, change to your service\nconst DEFAULT_CHAR = '0000ffe1-0000-1000-8000-00805f9b34fb';\nexport default function BluetoothReader() {\n  _s();\n  const [status, setStatus] = useState('idle');\n  const [deviceName, setDeviceName] = useState(null);\n  const [bleData, setBleData] = useState(null);\n  const [serverRef, setServerRef] = useState(null);\n  const connect = async () => {\n    try {\n      setStatus('requesting');\n      const opts = {\n        filters: [{\n          namePrefix: 'ESP'\n        }],\n        // ESP32 BLE device name prefix; adjust as needed\n        optionalServices: [DEFAULT_SERVICE]\n      };\n      const device = await navigator.bluetooth.requestDevice(opts);\n      setDeviceName(device.name || device.id);\n      setStatus('connecting');\n      const server = await device.gatt.connect();\n      setServerRef(server);\n      const service = await server.getPrimaryService(DEFAULT_SERVICE);\n      const char = await service.getCharacteristic(DEFAULT_CHAR);\n      await char.startNotifications();\n      char.addEventListener('characteristicvaluechanged', e => {\n        const value = new TextDecoder().decode(e.target.value);\n        setBleData(value);\n      });\n      setStatus('connected');\n      device.ongattserverdisconnected = () => {\n        setStatus('disconnected');\n      };\n    } catch (err) {\n      console.error('BLE error', err);\n      setStatus('error');\n    }\n  };\n  const disconnect = async () => {\n    try {\n      if (serverRef && serverRef.connected) {\n        serverRef.disconnect();\n      }\n    } catch (err) {\n      console.warn('disconnect err', err);\n    } finally {\n      setStatus('idle');\n      setDeviceName(null);\n      setBleData(null);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"card\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Bluetooth (optional)\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"Status:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 9\n      }, this), \" \", status]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: connect,\n        disabled: status === 'connecting' || status === 'connected',\n        children: \"Connect BLE\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: disconnect,\n        disabled: status !== 'connected',\n        children: \"Disconnect\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"Device:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 9\n      }, this), \" \", deviceName !== null && deviceName !== void 0 ? deviceName : '—']\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"Last BLE data:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"pre\", {\n        style: {\n          whiteSpace: 'pre-wrap',\n          wordBreak: 'break-word'\n        },\n        children: bleData !== null && bleData !== void 0 ? bleData : '—'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"muted\",\n      children: \"Note: This is optional \\u2014 using ThingSpeak HTTP push is recommended for persistence.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 5\n  }, this);\n}\n_s(BluetoothReader, \"09MQS98tLvRs1/QvT41GaY7QF/E=\");\n_c = BluetoothReader;\nvar _c;\n$RefreshReg$(_c, \"BluetoothReader\");","map":{"version":3,"names":["React","useState","jsxDEV","_jsxDEV","DEFAULT_SERVICE","DEFAULT_CHAR","BluetoothReader","_s","status","setStatus","deviceName","setDeviceName","bleData","setBleData","serverRef","setServerRef","connect","opts","filters","namePrefix","optionalServices","device","navigator","bluetooth","requestDevice","name","id","server","gatt","service","getPrimaryService","char","getCharacteristic","startNotifications","addEventListener","e","value","TextDecoder","decode","target","ongattserverdisconnected","err","console","error","disconnect","connected","warn","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","disabled","style","whiteSpace","wordBreak","_c","$RefreshReg$"],"sources":["C:/Users/Shraddha sajwan/smart-water-frontend/src/components/BluetoothReader.js"],"sourcesContent":["import React, { useState } from 'react';\r\n\r\nconst DEFAULT_SERVICE = '0000ffe0-0000-1000-8000-00805f9b34fb'; // example, change to your service\r\nconst DEFAULT_CHAR = '0000ffe1-0000-1000-8000-00805f9b34fb';\r\n\r\nexport default function BluetoothReader() {\r\n  const [status, setStatus] = useState('idle');\r\n  const [deviceName, setDeviceName] = useState(null);\r\n  const [bleData, setBleData] = useState(null);\r\n  const [serverRef, setServerRef] = useState(null);\r\n\r\n  const connect = async () => {\r\n    try {\r\n      setStatus('requesting');\r\n      const opts = {\r\n        filters: [{ namePrefix: 'ESP' }], // ESP32 BLE device name prefix; adjust as needed\r\n        optionalServices: [DEFAULT_SERVICE]\r\n      };\r\n      const device = await navigator.bluetooth.requestDevice(opts);\r\n      setDeviceName(device.name || device.id);\r\n      setStatus('connecting');\r\n      const server = await device.gatt.connect();\r\n      setServerRef(server);\r\n      const service = await server.getPrimaryService(DEFAULT_SERVICE);\r\n      const char = await service.getCharacteristic(DEFAULT_CHAR);\r\n      await char.startNotifications();\r\n      char.addEventListener('characteristicvaluechanged', e => {\r\n        const value = new TextDecoder().decode(e.target.value);\r\n        setBleData(value);\r\n      });\r\n      setStatus('connected');\r\n      device.ongattserverdisconnected = () => {\r\n        setStatus('disconnected');\r\n      };\r\n    } catch (err) {\r\n      console.error('BLE error', err);\r\n      setStatus('error');\r\n    }\r\n  };\r\n\r\n  const disconnect = async () => {\r\n    try {\r\n      if (serverRef && serverRef.connected) {\r\n        serverRef.disconnect();\r\n      }\r\n    } catch (err) {\r\n      console.warn('disconnect err', err);\r\n    } finally {\r\n      setStatus('idle');\r\n      setDeviceName(null);\r\n      setBleData(null);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"card\">\r\n      <h2>Bluetooth (optional)</h2>\r\n      <div>\r\n        <strong>Status:</strong> {status}\r\n      </div>\r\n      <div>\r\n        <button onClick={connect} disabled={status === 'connecting' || status === 'connected'}>\r\n          Connect BLE\r\n        </button>\r\n        <button onClick={disconnect} disabled={status !== 'connected'}>\r\n          Disconnect\r\n        </button>\r\n      </div>\r\n      <div>\r\n        <strong>Device:</strong> {deviceName ?? '—'}\r\n      </div>\r\n      <div>\r\n        <strong>Last BLE data:</strong>\r\n        <pre style={{whiteSpace:'pre-wrap',wordBreak:'break-word'}}>{bleData ?? '—'}</pre>\r\n      </div>\r\n      <p className=\"muted\">Note: This is optional — using ThingSpeak HTTP push is recommended for persistence.</p>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}